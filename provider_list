import re
import mysql.connector

conn = mysql.connector.connect(host = 'localhost',username = 'root', password = '',database = 'medical_tool')
cursor = conn.cursor()


sql_token = """select regex_tokens from provider_regex"""
cursor.execute(sql_token)
res_token = cursor.fetchall()
for token in res_token:
    Token = "".join(token)
    
    sql_delimit = """select token_delimiter from delimiter_regex"""
    cursor.execute(sql_delimit)
    res_delimit = cursor.fetchall()
    for delimiter in res_delimit:
        regex_list = list(token+delimiter)
        Regex = "".join(regex_list)
        sql = """select pk_content_id,page_content from mt_page_file_contents """
        cursor.execute(sql)
        res = cursor.fetchall()
        for text_row in res:
            text_id = text_row[0]
            text = text_row[1]
            provider = re.search(Regex,text)
            #print(provider)
        #to fetch
            if(provider != None): 
                prov_res = provider.group()                
                prov_split = prov_res.split(Token)        
                for word in prov_split:
                    if(len(word)> 2):
                        print(Token,word)
                        print(text_id)
                        print(" ")
                        
       
